<html>
   <head>
       <title>Verify with Wyre</title>

   </head>
   <body>
       <button id="verify-button" class="btn btn-primary mt-5">Verify with Wyre</button>

       <script src="https://verify.sendwyre.com/js/widget-loader.js"></script>
       <script type="text/javascript">
       (function() {
           var deviceToken = localStorage.getItem("DEVICE_TOKEN");
           if(!deviceToken) {
               var array = new Uint8Array(25);
               window.crypto.getRandomValues(array);
               deviceToken = Array.prototype.map.call(array, x => ("00" + x.toString(16)).slice(-2)).join('');
               localStorage.setItem("DEVICE_TOKEN", deviceToken);
           }

           var widget = new Wyre.Widget({
               env: "test",
               accountId: 'AC-ZMQDYZ3JQJ4', //accountId ??? our??
               auth: {
                   type: 'secretKey',
                   secretKey: deviceToken, // deviceToken
               },
               operation: {
                   type: "debitcard",
                   destCurrency: "ETH", //symbol
                   sourceAmount: 0.01, //amount (or sourceAmount)
                   dest:"ethereum:0x43ECDb9cf0bd4345B009e8B279567e9B4F4631aF" //ethereum:${contractAddress}
               }
           });

           widget.on('close', function(e) {
             // the widget closed before completing the process

             if(e.error) {
               console.log("there was a problem: ", e.error);
             } else {
               console.log("the customer closed the widget");
             }
           });

           widget.on('complete', function(e) {
             // onboarding was completed successfully!
           });

           document.getElementById("verify-button").addEventListener('click', function(e) {
               widget.open();
           })
       })();
       </script>
   </body>
</html>